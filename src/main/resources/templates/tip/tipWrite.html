<!DOCTYPE html>
<html lang="ko" 
    xmlns:th="http://www.thymeleaf.org" 
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<title>꿀팁 작성 페이지</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
<link rel="stylesheet" href="https://code.jquery.com/ui/1.14.0/themes/base/jquery-ui.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
<link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
      
    <div id="wrap"  class="d-flex">
       <nav class="main-manu">
           <div class="btn-group dropright ml-2">
                <button type="button" class="btn dropdown-toggle" data-toggle="dropdown">
                    <i class="bi bi-blockquote-right"></i>
                </button>
                <div class="dropdown-menu">
                    <div class="ml-4"><a href="/bookmarks/mybookmarkview">즐겨찾기</a></div>
                    <div class="ml-4"><a href="/tip/list-view">꿀팁</a></div>
                    <div class="ml-4"><a href="#">내정보</a></div>
                </div>
            </div>
            <div class="market-logo text-center">
               <ul class="nav">       
                   <li class="nav-item"><a href="/ssave/listViewNew" class="nav-link text-dark">신작작품</a></li>
                   <li class="nav-item"><a href="/ssave/listViewNewSpecial" class="nav-link text-dark">화제의 신작작품</a></li>
                   <li class="nav-item"><a href="/ssave/listMusic" class="nav-link text-dark">최고의 음반</a></li>
                   <li class="nav-item"><a href="/ssave/listNewMusic" class="nav-link text-dark">최신 음반</a></li>
                   <li class="nav-item"><a href="/ssave/listDvd" class="nav-link text-dark">인기 DVD</a></li>
                   <li class="nav-item"><a href="/ssave/listNewDvd" class="nav-link text-dark">최신 DVD</a></li>
               </ul>
            </div>
        </nav>
        <div class="section ml-3">
            <div class="d-flex justify-content-between">
                <a href="/ssave/listView" class="text-dark logo display-4 font-weight-bold">SSave</a>
                <div class="mt-5 mr-5 d-flex">
                    <p th:if="${session.userName != null}" th:text="${session.userName}"></p>
                    <p th:if="${session.kakaoNickName != null && session.userName == null}" th:text="${session.kakaoNickName}"></p>
                    <a href="/user/logout">로그아웃</a>
                </div>
            </div>
            <h3 class="mt-3">여러분의 소중한 꿀팁을 공유 해주세요</h3>
            <input placeholder="제목을 입력해주세요" class="mt-5 col-12 form-control" type="text" id="titleInput">
            <div class="mt-3">
                <textarea class="pl-2 pt-2 form-control" placeholder="내용을 입력하세요" rows="15" cols="150" id="contentsInput"></textarea>
            </div>
            <div class="d-flex mt-3 justify-content-between">
                <div class="item-box border border-1 text-center" id="productInput">
                    <a class="tip-link" th:if="${item != null}" th:href="${item.link}" th:data-item-link="${item.link}">
                        <img class="tip-Image" th:if="${item != null}" th:src="${item.cover}" th:data-item-cover="${item.cover}">
                    </a>
                </div>
                <button class="form-control bg-success col-2 text-white" id="tipBtn">올리기</button>
            </div>
         </div>
      </div>






        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
        <script>
            $(document).ready(function(){
            	
                $("#tipBtn").on("click",function(){
                	
                	let title = $("#titleInput").val();
                	let contents = $("#contentsInput").val();
                	let cover = $(".tip-Image").data("item-cover") || null;
                	let link = $(".tip-link").data("item-link") || null;
                	
                	if(title == ""){
                		alert("제목을 입력해주세요");
                		return;
                	}
                	
                	if(contents == ""){
                        alert("내용을 입력해주세요");
                        return;
                    }
                	
                	
                	$.ajax({
                		type:"post"
                		, url:"/tip/create"
                		, data:{"title":title, "contents":contents, "cover":cover, "link":link}
                	    , success:function(data){
                	    	if(data.result == "success"){
                	    		location.href = "/tip/list-view";
                	    	}else{
                	    		alert("입력 실패");
                	    	}
                	    }
                	    , error:function(){
                	    	alert("입력 오류");
                	    }
                	});
                
                });
            	
            	
            	
            	
            	
            	
            });    
        
        </script>

</body>
</html>